# üîç –°—Ç–∞—Ç—É—Å DSL –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ –ø—Ä–æ–µ–∫—Ç–µ

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 10 –Ω–æ—è–±—Ä—è 2025

---

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

### ‚úÖ –ß—Ç–æ –£–ñ–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

#### 1. **–§–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –¥–ª—è AI**
**–ü—É—Ç—å:** `/templates/DSL_VARIABLES.txt` (431 —Å—Ç—Ä–æ–∫–∞)

**–°–æ–¥–µ—Ä–∂–∏—Ç:**
- üìÇ Chrome –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (3 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
- üé∂ TikTok –æ–ø–µ—Ä–∞—Ü–∏–∏ (6 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)
- ‚ñ∂Ô∏è YouTube –æ–ø–µ—Ä–∞—Ü–∏–∏ (5 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)
- üîÑ –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (3 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
- üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- üìñ –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è AI

**–ü—Ä–∏–º–µ—Ä—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:**
```
${ChromeOpen}          - –û—Ç–∫—Ä—ã—Ç—å Chrome –∏ –Ω–æ–≤—É—é –≤–∫–ª–∞–¥–∫—É
${TikTokOpen}          - –û—Ç–∫—Ä—ã—Ç—å TikTok
${TikTokLike}          - –ü–æ—Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫
${YouTubeSearch:query} - –ù–∞–π—Ç–∏ –≤–∏–¥–µ–æ –Ω–∞ YouTube
${TikTokAutoLikes:N}   - –ü–æ—Å—Ç–∞–≤–∏—Ç—å N –ª–∞–π–∫–æ–≤
```

---

#### 2. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ –ø–∞—Ä—Å–µ—Ä–µ**
**–§–∞–π–ª:** `src/core/macro_sequence.py` (—Å—Ç—Ä–æ–∫–∞ 227-232)

```python
def _resolve_variable(self, value):
    """–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–∏–¥–∞ ${var_name}"""
    if isinstance(value, str) and value.startswith('${') and value.endswith('}'):
        var_name = value[2:-1]
        return self.variables.get(var_name, value)
    return value
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ö–æ–¥ –µ—Å—Ç—å, –Ω–æ **–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø**

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–∫ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –¥–ª—è AI, –Ω–µ –∫–∞–∫ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥

---

#### 3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
**–§–∞–π–ª:** `docs/guides/dsl/variables-fix.md` (295 —Å—Ç—Ä–æ–∫)

**–°–æ–¥–µ—Ä–∂–∏—Ç:**
- –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–æ—á–µ–º—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –∫–æ–¥
- –ö–∞–∫ AI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–∞–∫ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫
- –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

---

#### 4. **–ü—É–Ω–∫—Ç –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é**
**–§–∞–π–ª:** `src/main.py` (—Å—Ç—Ä–æ–∫–∞ 483)

```python
"üìù –ì–µ–Ω–µ—Ä–∞—Ü–∏—è DSL –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (AI)"
```

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ü—É–Ω–∫—Ç –ï–°–¢–¨, –Ω–æ **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù**

---

## ‚ùå –ß—Ç–æ –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

### 1. **–ü–∞—Ä—Å–∏–Ω–≥ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ .atlas —Ñ–∞–π–ª–∞—Ö**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–∞—Ä—Å–µ—Ä –ù–ï —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç `${...}` –≤ –∫–æ–¥

**–ü—Ä–∏–º–µ—Ä:**
```atlas
# –ù–ï –†–ê–ë–û–¢–ê–ï–¢ ‚ùå
${ChromeOpen}
${TikTokOpen}
${TikTokLike}
```

**–û—à–∏–±–∫–∞:** –ü–∞—Ä—Å–µ—Ä –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `${...}`

---

### 2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ AI**
**–°—Ç–∞—Ç—É—Å:** –ü—É–Ω–∫—Ç –º–µ–Ω—é –µ—Å—Ç—å, –Ω–æ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞

**–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```python
def generate_dsl_variables(self):
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è DSL –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ AI"""
    # TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å
    pass
```

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –ó–∞–ø—Ä–æ—Å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è
- AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- AI –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `DSL_VARIABLES.txt`

---

### 3. **–û—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö**
**–°—Ç–∞—Ç—É—Å:** –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**–ß—Ç–æ –µ—Å—Ç—å:**
- `/templates/DSL_VARIABLES.txt` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –¥–ª—è AI

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- `/dsl_references/USER_VARIABLES.txt` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- –§–æ—Ä–º–∞—Ç: –Ω–∞–∑–≤–∞–Ω–∏–µ + –æ–ø–∏—Å–∞–Ω–∏–µ + –∫–æ–¥
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ AI –ø—Ä–æ–º–ø—Ç

---

### 4. **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é**
**–°—Ç–∞—Ç—É—Å:** –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–∞–∫—Ä–æ—Å–∞ AI —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç:
```
‚úÖ –ú–∞–∫—Ä–æ—Å —Å–æ–∑–¥–∞–Ω: youtube_search.atlas

üí° –•–æ—Ç–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é?
   –ù–∞–∑–≤–∞–Ω–∏–µ: ${YouTubeSearch}
   –û–ø–∏—Å–∞–Ω–∏–µ: –ù–∞–π—Ç–∏ –∏ –æ—Ç–∫—Ä—ã—Ç—å –ø–µ—Ä–≤–æ–µ –≤–∏–¥–µ–æ –Ω–∞ YouTube
   
   (y/n):
```

---

## üéØ –¢–≤–æ—è –∏–¥–µ—è - –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è:

**1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –º–∞–∫—Ä–æ—Å —á–µ—Ä–µ–∑ AI**
```
"–û—Ç–∫—Ä–æ–π YouTube –∏ –Ω–∞–π–¥–∏ trending videos"
```

**2. AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥**
```atlas
open ChromeApp
wait 2s
click ChromeNewTab
wait 1s
click ChromeSearchField
type "youtube.com"
press enter
wait 5s
click Chrome-YouTube-SearchField
type "trending videos"
press enter
wait 3s
click Chrome-YouTube-VideoFirst
wait 5s
```

**3. AI –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é**
```
üí° –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é?

–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ: ${YouTubeSearchTrending}
–û–ø–∏—Å–∞–Ω–∏–µ: –û—Ç–∫—Ä—ã—Ç—å YouTube –∏ –Ω–∞–π—Ç–∏ trending videos

(y/n): y
```

**4. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è**

**–§–∞–π–ª:** `/dsl_references/USER_VARIABLES.txt`
```
${YouTubeSearchTrending}
--------------------------------------------------------------------------------
–û–ø–∏—Å–∞–Ω–∏–µ: –û—Ç–∫—Ä—ã—Ç—å YouTube –∏ –Ω–∞–π—Ç–∏ trending videos
–°–æ–∑–¥–∞–Ω–æ: 2025-11-10
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π: 0

–ö–æ–¥:
open ChromeApp
wait 2s
click ChromeNewTab
wait 1s
click ChromeSearchField
type "youtube.com"
press enter
wait 5s
click Chrome-YouTube-SearchField
type "trending videos"
press enter
wait 3s
click Chrome-YouTube-VideoFirst
wait 5s
```

**5. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –ø–æ–ø–∞–¥–∞–µ—Ç –≤ AI –ø—Ä–æ–º–ø—Ç**
```
üìö –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨–°–ö–ò–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï:

${YouTubeSearchTrending}
–û–ø–∏—Å–∞–Ω–∏–µ: –û—Ç–∫—Ä—ã—Ç—å YouTube –∏ –Ω–∞–π—Ç–∏ trending videos
–ö–æ–¥: [—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –∫–æ–¥]
```

**6. –¢–µ–ø–µ—Ä—å AI –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ù–∞–π–¥–∏ trending videos –∏ –ø–æ—Å—Ç–∞–≤—å –ª–∞–π–∫"

AI –≤–∏–¥–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é ${YouTubeSearchTrending} –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç:

open ChromeApp
wait 2s
click ChromeNewTab
wait 1s
click ChromeSearchField
type "youtube.com"
press enter
wait 5s
click Chrome-YouTube-SearchField
type "trending videos"
press enter
wait 3s
click Chrome-YouTube-VideoFirst
wait 5s
click Chrome-YouTube-Like
wait 1.5s
```

---

## üöÄ –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ü–∞—Ä—Å–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö ‚úÖ (—á–∞—Å—Ç–∏—á–Ω–æ –≥–æ—Ç–æ–≤)

**–§–∞–π–ª:** `src/core/atlas_dsl_parser.py`

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```python
class AtlasDSLParser:
    def __init__(self, file_path):
        self.variables = {}  # –•—Ä–∞–Ω–∏–ª–∏—â–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
        self.load_variables()  # –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ —Ñ–∞–π–ª–∞
    
    def load_variables(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ USER_VARIABLES.txt"""
        var_file = Path('dsl_references/USER_VARIABLES.txt')
        if var_file.exists():
            # –ü–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–∞
            # –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ self.variables
            pass
    
    def expand_variable(self, var_name: str, params: dict = None) -> List[str]:
        """–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –≤ –∫–æ–¥"""
        if var_name in self.variables:
            code = self.variables[var_name]['code']
            # –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ {param}
            if params:
                for key, value in params.items():
                    code = code.replace(f'{{{key}}}', value)
            return code.split('\n')
        return []
    
    def parse_line(self, line: str):
        """–ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä–æ–∫–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö"""
        # –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å ${
        if line.strip().startswith('${'):
            # –ò–∑–≤–ª–µ—á—å –∏–º—è –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            # ${TikTokComment:–û—Ç–ª–∏—á–Ω–æ–µ –≤–∏–¥–µ–æ!}
            match = re.match(r'\$\{([^:}]+)(?::(.+))?\}', line.strip())
            if match:
                var_name = match.group(1)
                params_str = match.group(2)
                
                # –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
                expanded = self.expand_variable(var_name, parse_params(params_str))
                
                # –ü–∞—Ä—Å–∏—Ç—å –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É
                for exp_line in expanded:
                    self.parse_line(exp_line)
                return
        
        # –û–±—ã—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥
        # ...
```

---

### –≠—Ç–∞–ø 2: –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ AI

**–§–∞–π–ª:** `src/ai/variable_generator.py` (–Ω–æ–≤—ã–π)

```python
class AIVariableGenerator:
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è DSL –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ AI"""
    
    def __init__(self, project_root: Path):
        self.project_root = project_root
        self.variables_file = project_root / 'dsl_references' / 'USER_VARIABLES.txt'
        self.gemini_key = api_config.gemini_key
    
    def generate_variable(self, user_request: str) -> Dict:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ –∑–∞–ø—Ä–æ—Å—É"""
        
        # 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ —á–µ—Ä–µ–∑ AIMacroGenerator
        generator = AIMacroGenerator(self.project_root)
        code = generator.generate_with_gemini(user_request)
        
        # 2. AI –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
        var_name = self.suggest_variable_name(user_request, code)
        
        # 3. AI —Å–æ–∑–¥–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ
        description = self.generate_description(user_request, code)
        
        return {
            'name': var_name,
            'description': description,
            'code': code,
            'created': datetime.now().isoformat()
        }
    
    def suggest_variable_name(self, request: str, code: str) -> str:
        """AI –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π"""
        prompt = f"""
–ü—Ä–µ–¥–ª–æ–∂–∏ –∫–æ—Ä–æ—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è DSL –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.

–ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {request}
–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥: {code}

–§–æ—Ä–º–∞—Ç: CamelCase, –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∑–∞–≥–ª–∞–≤–Ω–æ–π –±—É–∫–≤—ã
–ü—Ä–∏–º–µ—Ä—ã: YouTubeSearch, TikTokAutoLikes, ChromeOpen

–û—Ç–≤–µ—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏–µ–º, –±–µ–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π.
"""
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Gemini
        response = self.client.models.generate_content(
            model=api_config.gemini_model,
            contents=prompt
        )
        
        return response.text.strip()
    
    def save_variable(self, variable: Dict):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –≤ —Ñ–∞–π–ª"""
        with open(self.variables_file, 'a', encoding='utf-8') as f:
            f.write(f"\n${{{variable['name']}}}\n")
            f.write("-" * 80 + "\n")
            f.write(f"–û–ø–∏—Å–∞–Ω–∏–µ: {variable['description']}\n")
            f.write(f"–°–æ–∑–¥–∞–Ω–æ: {variable['created']}\n")
            f.write(f"–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π: 0\n\n")
            f.write("–ö–æ–¥:\n")
            f.write(variable['code'])
            f.write("\n\n")
```

---

### –≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

**–§–∞–π–ª:** `src/main.py`

```python
def ai_automation_menu(self):
    """–ú–µ–Ω—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (AI)"""
    
    while True:
        self.print_header()
        
        options = [
            "üèóÔ∏è  –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —à–∞–±–ª–æ–Ω–æ–≤ (AI)",
            "üìù –ì–µ–Ω–µ—Ä–∞—Ü–∏—è DSL –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (AI)",  # ‚Üê –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å
            "üîÆ –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é (AI)",
        ]
        
        self.print_menu("üí° –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–Ø –ü–†–û–¶–ï–°–°–û–í (AI)", options)
        choice = self.get_choice(len(options))
        
        if choice == 0:
            break
        elif choice == 1:
            self.create_template_architecture()
        elif choice == 2:
            self.generate_dsl_variable()  # ‚Üê –ù–û–í–û–ï
        elif choice == 3:
            self.suggest_optimization()

def generate_dsl_variable(self):
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è DSL –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —á–µ—Ä–µ–∑ AI"""
    from src.ai.variable_generator import AIVariableGenerator
    
    print("\nüìù –ì–ï–ù–ï–†–ê–¶–ò–Ø DSL –ü–ï–†–ï–ú–ï–ù–ù–û–ô")
    print("-" * 80)
    
    # –ó–∞–ø—Ä–æ—Å –æ–ø–∏—Å–∞–Ω–∏—è
    request = input("–û–ø–∏—à–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: ").strip()
    if not request:
        return
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è
    generator = AIVariableGenerator(self.project_root)
    variable = generator.generate_variable(request)
    
    # –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
    print(f"\nüí° –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è:")
    print(f"   –ù–∞–∑–≤–∞–Ω–∏–µ: ${{{variable['name']}}}")
    print(f"   –û–ø–∏—Å–∞–Ω–∏–µ: {variable['description']}")
    print(f"\n   –ö–æ–¥:")
    for line in variable['code'].split('\n'):
        print(f"   {line}")
    
    # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
    confirm = input(f"\nüíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é? (y/n): ").strip().lower()
    if confirm == 'y':
        generator.save_variable(variable)
        print(f"‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è ${{{variable['name']}}} —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!")
        print(f"üìÅ –§–∞–π–ª: dsl_references/USER_VARIABLES.txt")
    else:
        print("‚ùå –û—Ç–º–µ–Ω–µ–Ω–æ")
    
    input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...")
```

---

### –≠—Ç–∞–ø 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ AI –ø—Ä–æ–º–ø—Ç

**–§–∞–π–ª:** `src/ai/macro_generator.py`

```python
def load_user_variables(self) -> str:
    """–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö"""
    var_file = self.project_root / 'dsl_references' / 'USER_VARIABLES.txt'
    
    if not var_file.exists():
        return ""
    
    with open(var_file, 'r', encoding='utf-8') as f:
        content = f.read()
    
    return f"""
üìö –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨–°–ö–ò–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï:

{content}

üí° –ò—Å–ø–æ–ª—å–∑—É–π —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–≥–¥–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç!
"""

def build_optimized_prompt(self, user_input: str) -> str:
    """–°—Ç—Ä–æ–∏—Ç –ø—Ä–æ–º–ø—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏"""
    
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...
    
    # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    user_vars = self.load_user_variables()
    
    prompt = f"""–¢—ã ‚Äî AI-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä DSL –º–∞–∫—Ä–æ—Å–æ–≤.

{templates}

{commands}

{practices}

{user_vars}  # ‚Üê –ù–û–í–û–ï

üéØ –§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê:
...

‚è© INPUT: {user_input}
"""
    
    return prompt
```

---

### –≠—Ç–∞–ø 5: –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**–§–∞–π–ª:** `src/main.py`

```python
def generate_sequence_ai(self):
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ AI"""
    
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ...
    
    # –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
    if result:
        print(f"\n‚úÖ –ú–∞–∫—Ä–æ—Å —Å–æ–∑–¥–∞–Ω: {filepath}")
        
        # –ù–û–í–û–ï: –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
        save_as_var = input("\nüí° –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é? (y/n): ").strip().lower()
        
        if save_as_var == 'y':
            from src.ai.variable_generator import AIVariableGenerator
            
            var_gen = AIVariableGenerator(self.project_root)
            
            # AI –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ
            var_name = var_gen.suggest_variable_name(user_input, result['dsl'])
            print(f"\n   –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ: ${{{var_name}}}")
            
            # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å
            custom_name = input("   –ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ —Å–≤–æ–µ (Enter = –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–µ): ").strip()
            if custom_name:
                var_name = custom_name
            
            # –û–ø–∏—Å–∞–Ω–∏–µ
            description = input("   –û–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π: ").strip() or user_input
            
            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
            variable = {
                'name': var_name,
                'description': description,
                'code': result['dsl'],
                'created': datetime.now().isoformat()
            }
            
            var_gen.save_variable(variable)
            print(f"\n‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è ${{{var_name}}} —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!")
            print(f"   –¢–µ–ø–µ—Ä—å AI —Å–º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –≤ –±—É–¥—É—â–∏—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏—è—Ö!")
```

---

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. **–ü–∞–º—è—Ç—å AI**
- AI –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ù–µ –Ω—É–∂–Ω–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ
- –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –∑–Ω–∞–Ω–∏–π –æ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 2. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞**
```
–ë—ã–ª–æ:
–ö–∞–∂–¥—ã–π —Ä–∞–∑ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å "–æ—Ç–∫—Ä—ã—Ç—å YouTube –∏ –Ω–∞–π—Ç–∏ –≤–∏–¥–µ–æ"

–°—Ç–∞–ª–æ:
${YouTubeSearch:query} - –≥–æ—Ç–æ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
```

### 3. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è**
```
${MyDailyRoutine}
${MyFavoriteChannels}
${MyAutoLikes}
```

### 4. **–ë—ã—Å—Ç—Ä–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–°–¥–µ–ª–∞–π –º–æ–π daily routine"

AI: –ò—Å–ø–æ–ª—å–∑—É—é ${MyDailyRoutine}
[—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç –≥–æ—Ç–æ–≤—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å]
```

### 5. **–û–±—É—á–µ–Ω–∏–µ AI**
–ß–µ–º –±–æ–ª—å—à–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —Ç–µ–º —É–º–Ω–µ–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è AI

---

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
dsl_references/
‚îú‚îÄ‚îÄ DSL_REFERENCE.txt           # –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ DSL –∫–æ–º–∞–Ω–¥
‚îú‚îÄ‚îÄ USER_VARIABLES.txt          # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ‚≠ê –ù–û–í–û–ï
‚îî‚îÄ‚îÄ SYSTEM_VARIABLES.txt        # –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

templates/
‚îî‚îÄ‚îÄ DSL_VARIABLES.txt           # –ë–∞–∑–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–¥–ª—è AI)

src/
‚îú‚îÄ‚îÄ ai/
‚îÇ   ‚îú‚îÄ‚îÄ macro_generator.py      # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–∞–∫—Ä–æ—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ variable_generator.py   # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö ‚≠ê –ù–û–í–û–ï
‚îÇ
‚îî‚îÄ‚îÄ core/
    ‚îî‚îÄ‚îÄ atlas_dsl_parser.py     # –ü–∞—Ä—Å–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö ‚≠ê –û–ë–ù–û–í–ò–¢–¨
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ `${...}` –≤ .atlas —Ñ–∞–π–ª–∞—Ö
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ USER_VARIABLES.txt
- [ ] –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ –∫–æ–¥
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ `${Var:param}`

### AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è:
- [ ] –°–æ–∑–¥–∞—Ç—å AIVariableGenerator
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏—è
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—É–Ω–∫—Ç –º–µ–Ω—é "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è DSL –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö"
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–∞–∫—Ä–æ—Å–∞
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ USER_VARIABLES –≤ AI –ø—Ä–æ–º–ø—Ç
- [ ] –¢–µ—Å—Ç—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- [ ] –û–±–Ω–æ–≤–∏—Ç—å DSL_VARIABLES_STATUS.md
- [ ] –°–æ–∑–¥–∞—Ç—å USER_VARIABLES_GUIDE.md
- [ ] –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- [ ] Best practices

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–¢–≤–æ—è –∏–¥–µ—è - –û–¢–õ–ò–ß–ù–ê–Ø!** üöÄ

### –ß—Ç–æ —É–∂–µ –µ—Å—Ç—å:
- ‚úÖ –ë–∞–∑–æ–≤—ã–π —Ñ–∞–π–ª DSL_VARIABLES.txt
- ‚úÖ –ú–µ—Ç–æ–¥ _resolve_variable –≤ –ø–∞—Ä—Å–µ—Ä–µ
- ‚úÖ –ü—É–Ω–∫—Ç –≤ –º–µ–Ω—é
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:
- ‚è≥ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- ‚è≥ –°–æ–∑–¥–∞—Ç—å AIVariableGenerator
- ‚è≥ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –º–µ–Ω—é
- ‚è≥ –î–æ–±–∞–≤–∏—Ç—å –≤ AI –ø—Ä–æ–º–ø—Ç
- ‚è≥ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å

### –û—Ü–µ–Ω–∫–∞ —Ä–∞–±–æ—Ç—ã:
- **–ü–∞—Ä—Å–µ—Ä:** ~2-3 —á–∞—Å–∞
- **AI –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä:** ~2-3 —á–∞—Å–∞
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** ~1-2 —á–∞—Å–∞
- **–¢–µ—Å—Ç—ã:** ~1 —á–∞—Å
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** ~1 —á–∞—Å

**–ò—Ç–æ–≥–æ:** ~7-10 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
**AI —Å –ø–∞–º—è—Ç—å—é, –∫–æ—Ç–æ—Ä—ã–π —É—á–∏—Ç—Å—è –Ω–∞ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!** üß†‚ú®

---

**–ì–æ—Ç–æ–≤ –Ω–∞—á–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é?** üöÄ
